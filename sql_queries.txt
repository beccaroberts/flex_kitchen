


CREATE TABLE `person` ( `id` INT UNSIGNED NOT NULL , 
`firstname` VARCHAR(30) NOT NULL , 
`lastname` VARCHAR(30) NOT NULL , 
`email` VARCHAR(50) NOT NULL , 
`tel_no` INT UNSIGNED NOT NULL , 
`account_balance` double NOT NULL , 
PRIMARY KEY (`id`)) 
ENGINE = InnoDB;


CREATE TABLE `category` ( 
`id` INT NOT NULL , 
`name` VARCHAR(30) NOT NULL , 
PRIMARY KEY (`id`)) 
ENGINE = InnoDB;

CREATE TABLE `person_article_matrix` ( 
`id` INT NOT NULL , 
`person_id` INT NOT NULL , 
`article_id` INT NOT NULL , 
`count` INT NOT NULL , 
`buy_date` DATETIME NOT NULL,
PRIMARY KEY (`id`)) 
ENGINE = InnoDB;


CREATE USER 'flex_kitchen'@'localhost' IDENTIFIED BY 'root'
grant all privileges on flex_kitchen.* to flex_kitchen@'%' identified by 'root'

Insert Person

INSERT INTO `person`(`firstname`, `lastname`, `email`, `tel_no`, `img_path`, `account_balance`, `is_admin`, `user_pw`) 
VALUES ('flex_firstname','flex_lastname','admin@flex.de',111,'admin.png',0,1,'897a779351421523cadbafccdce22efe')


//Trigger
begin
 DECLARE oldBalance FLOAT;
 DECLARE articlePrice FLOAT;
 DECLARE articleCount INT;
 DECLARE newBalance FLOAT;
 
 SET oldBalance = (SELECT account_balance FROM person WHERE id = NEW.person_id); 
 SET articlePrice = (SELECT price from article where id = NEW.article_id);
 SET articleCount = (SELECT count from article where id = NEW.article_id);
 SET newBalance = oldBalance - articlePrice; 
 UPDATE person
 SET person.account_balance = newBalance
 WHERE person.id = NEW.person_id;
 
 UPDATE article
 SET article.count = articleCount-1
 WHERE article.id = NEW.article_id;
      
END